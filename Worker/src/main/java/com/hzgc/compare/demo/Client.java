package com.hzgc.compare.demo;

import com.hzgc.compare.rpc.client.RpcClient;
import com.hzgc.compare.rpc.client.result.AllReturn;
import com.hzgc.compare.rpc.protocol.JsonUtil;
import com.hzgc.compare.worker.Service;
import com.hzgc.compare.worker.common.CompareParam;
import com.hzgc.compare.worker.common.Feature;
import com.hzgc.compare.worker.common.SearchResult;
import com.hzgc.compare.worker.util.FaceObjectUtil;

import java.util.ArrayList;
import java.util.List;

public class Client {
    public static void main(String[] args) throws InterruptedException {
        RpcClient rpcClient = new RpcClient("172.18.18.105:2181,172.18.18.106:2181,172.18.18.107:2181");
        Thread.sleep(3000);
        Service service = rpcClient.createAll(Service.class);
//        service.stopTheWorker();
//        System.exit(0);
        List<String> ipcIds = new ArrayList<>();
        for(int i = 0; i < 10; i++){
            ipcIds.add("" + i);
        }
        float[] featute = new float[]{2.1783385f,-0.56258285f,-0.71289057f,2.24726f,4.403554f,0.110902384f,1.0347606f,2.0991583f,-2.93272f,-0.41105366f,-2.481345f,4.5244136f,0.2295451f,-1.3578924f,-0.91997707f,-0.74590755f,-2.0203838f,1.8630043f,4.1742554f,-0.4187439f,0.7861563f,-2.9255857f,-6.310042f,2.4381006f,-0.7271543f,2.5954685f,-1.5058111f,-2.2482154f,3.5578318f,-3.014266f,0.5050856f,5.5229754f,1.3834182f,1.8123125f,0.6023896f,-5.1417546f,-3.4768968f,-3.1517324f,-2.2133813f,5.4334292f,-0.29713827f,2.1851606f,3.0162475f,-0.4135138f,0.54025483f,-6.142504f,-0.5462427f,-0.90979785f,0.3525049f,-0.90181595f,-0.21953037f,-2.4411843f,0.17255262f,2.4755733f,-3.2960653f,1.3816118f,-0.21211682f,2.1377692f,-0.6739951f,0.12308353f,-0.71643096f,-4.8198333f,-1.8660468f,1.0494642f,1.4420009f,-3.0338485f,0.38101703f,-1.6075554f,-1.648149f,2.6592536f,-0.9293765f,5.398171f,1.5616484f,-2.651761f,1.866477f,0.282629f,-4.4791765f,-4.6636105f,0.9288113f,-2.2756078f,-0.1785117f,-4.2208657f,-2.0367575f,0.74508107f,0.663885f,-2.6769094f,3.0422919f,-3.6987789f,-0.95837915f,-2.0464473f,-1.4722323f,1.4040495f,-2.6097264f,0.2266591f,-0.418723f,1.4927355f,-3.6280448f,1.7731327f,1.6994283f,1.2647266f,-0.9116864f,-6.7210555f,0.4070866f,2.011968f,3.3857305f,-1.7255921f,1.9270663f,-3.008258f,1.0411296f,-0.15479185f,-4.036471f,-0.98960555f,-2.7537806f,-2.030766f,3.3454657f,-4.2839484f,2.2485328f,-1.4458058f,-2.7315378f,-0.47972825f,1.5781431f,0.7650519f,-0.7597458f,3.1917574f,-1.7068652f,1.869457f,-0.043526128f,-1.5801246f,-0.88615113f,-5.2162204f,2.045257f,0.68706316f,4.9143114f,1.2781019f,-1.6269503f,2.1268365f,-2.3694956f,4.5506854f,0.7248566f,-0.5365694f,2.023342f,-2.6163056f,-1.7997112f,-4.3309207f,-4.702115f,0.77838427f,3.38861f,1.4253358f,-1.3309684f,3.8423533f,1.4451888f,-2.058887f,-0.32679045f,-3.8733444f,-6.8521876f,-0.21817818f,-0.3526885f,-0.0980161f,-5.229416f,0.5868207f,1.3304201f,-1.22357f,-5.4186234f,-4.239577f,0.7539134f,1.8937725f,-1.159544f,3.3365684f,-0.4202554f,0.080041155f,-2.7748814f,-3.22233f,-0.37389836f,1.1862513f,-4.107333f,1.2142235f,2.919656f,-1.6870542f,1.4218396f,-2.3510475f,-2.4361165f,0.62139004f,2.2344294f,0.14133997f,3.0309587f,0.7527932f,-0.68407583f,3.8810332f,-4.915336f,-1.9727575f,-2.8991854f,2.6908128f,0.17579669f,-2.460981f,1.6000998f,2.9461505f,2.3005102f,-0.6621325f,2.1884987f,0.8411083f,3.5309095f,0.56215775f,-1.4954597f,1.0832431f,0.3607236f,2.0921504f,-3.1485577f,2.9283903f,4.1183715f,1.1011484f,-1.0374556f,0.11093296f,-1.1958863f,-0.4741954f,2.7860758f,3.3475056f,-1.1146775f,0.49347186f,4.236897f,2.3900695f,-1.4716153f,0.7915506f,-5.187028f,0.8656845f,-0.5202146f,-0.7617568f,-1.5923818f,0.24019918f,-4.157788f,-1.0385476f,-5.177871f,-2.6730237f,-5.169842f,3.713593f,1.4636836f,0.69627494f,-3.9977224f,2.5082276f,2.0134482f,-3.7552373f,1.7338184f,-1.2562239f,0.4435504f,-1.2890854f,3.9126132f,-2.015425f,4.3794603f,-1.8879489f,-1.154665f,-2.818189f,-5.39009f,-2.993009f,3.2344232f,-2.0698855f,4.033552f,2.6666536f,1.89565f,-0.64011294f,4.386598f,4.007972f,-1.6369182f,1.5733618f,1.5105262f,-0.622375f,2.7562885f,2.203555f,0.78815424f,-2.0754297f,1.0771393f,-0.7857554f,-1.3206966f,0.25413173f,-0.858071f,-2.7854176f,1.1745758f,4.6797485f,3.2561212f,2.9364855f,-3.2355294f,0.99981415f,-0.5400294f,-3.2621605f,2.8271837f,0.17166986f,1.0837682f,-0.051099926f,-3.3232534f,4.0721154f,-4.5891957f,-0.8734094f,1.6391941f,1.3374312f,1.7503392f,1.002142f,-0.8000257f,0.542537f,1.9464846f,-1.2554941f,2.598982f,-0.40726513f,3.8535295f,3.317849f,-1.5744793f,0.98601663f,0.3874668f,-0.65336686f,0.49091178f,0.8788434f,-1.7886405f,0.21290085f,-2.3850257f,-2.9583175f,1.4220681f,8.059087f,-3.295f,0.29926443f,2.9660287f,-1.3972027f,-0.20794502f,-1.4636691f,0.0395644f,-1.3227196f,2.9376252f,-1.6020133f,1.5251149f,1.8420342f,-2.0611322f,-1.5663915f,0.35977492f,-2.6874776f,-0.9842238f,0.4135111f,2.1926117f,1.0863873f,0.030417532f,-2.9539893f,1.9119471f,-1.6611432f,2.0661206f,-2.6776555f,-1.0807745f,0.9376882f,2.9140787f,-0.8421319f,-1.8535026f,-1.3084409f,1.2544512f,1.0918163f,1.0982618f,-3.4379842f,-3.5423832f,2.4675353f,4.6932797f,0.3112768f,-0.11639554f,1.384973f,-3.1243677f,-2.2524927f,-1.2863703f,-2.7521956f,0.31203166f,1.368658f,5.9206247f,2.2883604f,2.5791664f,0.033218905f,0.5589295f,-1.6646559f,3.3137436f,1.4896197f,-0.5456659f,-1.1581081f,-2.9009469f,1.7229913f,-0.5523995f,1.6988112f,-1.1000215f,-5.1803026f,-0.07361034f,-0.56486607f,-0.44478053f,-1.7708501f,2.7986338f,-4.959197f,-2.6944766f,1.6910777f,1.8053848f,6.980475f,-0.6674685f,-3.6797826f,-3.1262934f,2.701442f,3.8404431f,5.4122753f,-2.26715f,-1.4682174f,0.7443377f,1.5230501f,3.4442174f,1.0581878f,5.479876f,1.5043132f,2.923884f,-2.7532551f,-2.9702854f,-1.7629969f,2.8098428f,-4.223606f,2.752785f,2.5838122f,-0.6909586f,7.7622905f,-6.319632f,-2.9423273f,1.474857f,4.4979434f,1.3888375f,0.26938653f,2.5920992f,0.7763644f,-7.6346836f,-0.38895988f,-2.42978f,-6.196437f,-1.443558f,-0.34054273f,2.0048013f,-4.2496324f,-1.7951952f,3.2421253f,2.2421296f,-2.8338094f,-3.0324342f,-3.5852907f,4.3211136f,0.124060124f,-2.6200724f,4.2853746f,3.2778277f,3.6433542f,-2.0828824f,-2.1474338f,-2.6268394f,4.741613f,-0.31533098f,3.1939793f,1.6228994f,-0.22683874f,-0.24827878f,-1.0983026f,3.7833395f,-2.0967157f,0.33130673f,-6.1172895f,-0.43289462f,2.990085f,-0.36317545f,-3.0382915f,3.725006f,3.2091115f,6.0882196f,5.3985243f,-2.513191f,4.3729715f,4.32874f,0.053454548f,3.5088696f,-2.346345f,-1.6272867f,4.622449f,-2.1527264f,-0.42283976f,-4.3947415f,2.2828937f,3.1903963f,1.5338303f,-1.8867623f,2.8624887f,-0.32001096f,-1.1286557f,-1.8435216f,5.8151655f,2.5669081f,-0.9849613f,4.828448f,1.8040355f,1.8334017f,-2.594624f,-4.6285057f,2.0718284f,-5.629434f,2.025448f,-0.14701918f,-0.16804303f,3.2992117f,3.763987f,-0.12956077f,-2.984935f,-1.686731f,5.829381f,-0.95622647f,-0.29533544f,0.8083263f,3.0074499f,-1.4867336f,-2.3448238f,-5.4782867f,-3.5838683f,-5.6466365f,-2.4822252f,-3.2735853f,1.6662846f};
        float[] feature2 = new float[]{2.20186f,-1.1827306f,1.1546698f,4.611981f,4.452321f,-1.5227871f,-1.4272287f,-1.6150537f,-2.7964535f,-2.1292505f,-1.0313835f,1.3108739f,-7.0556f,2.6256979f,-2.0069034f,-0.7585267f,-0.094230905f,0.24842808f,1.4115058f,2.8556514f,-0.74134356f,1.4562293f,-3.2016912f,4.632621f,1.8323164f,2.1065106f,-0.5954073f,-0.2850078f,1.3203537f,0.6929876f,0.08172798f,3.1913507f,2.8152165f,-0.575755f,-3.5674605f,-5.412668f,0.8918687f,-1.1909277f,-0.1549777f,2.9362667f,1.2204131f,3.2488935f,2.161861f,-4.4654584f,-1.5977381f,1.3376315f,2.325889f,0.6425294f,-1.7875267f,2.165848f,-0.4977853f,-2.5030568f,1.3689908f,2.4455562f,-2.6012907f,-1.0452292f,2.8929162f,6.4768066f,-1.9151518f,-3.8885398f,2.4198413f,1.0327282f,0.7585852f,-0.48582897f,-2.7688644f,0.24649048f,-2.5743144f,0.33677134f,0.8827412f,1.720056f,-1.400207f,2.371013f,1.0634303f,-0.7366644f,-0.9553323f,2.9265044f,-2.9767601f,-4.426763f,-1.5572696f,-4.897549f,3.7635007f,2.1865184f,-1.9620832f,2.9262989f,4.1611977f,1.0462688f,1.0299425f,-3.306817f,-4.455813f,-0.44661745f,-3.529231f,-1.7719162f,1.088699f,6.260001f,-3.1183834f,2.3321593f,-0.66248566f,3.3339684f,-1.683607f,3.6182623f,-0.15700714f,0.31424952f,4.3318167f,0.3717694f,1.1836747f,-3.0818474f,1.6725686f,-3.844399f,-1.4640183f,-0.03658475f,-6.9447265f,-2.829621f,-1.7270782f,3.4226377f,3.625918f,-3.350484f,-3.9018278f,-3.6857266f,-0.73841155f,-2.793463f,4.658288f,-0.65550214f,3.5069487f,4.093051f,-0.86224693f,-3.6063638f,-4.8259797f,2.6864333f,-3.0707445f,-2.5127761f,-3.633558f,5.3471484f,2.328869f,2.1086895f,-0.766774f,4.9770465f,-3.7547867f,0.30264354f,-1.0032277f,-0.834899f,-1.5130235f,-3.0713644f,4.497516f,3.0443625f,-3.3327146f,0.8796108f,0.6725819f,-1.4060786f,-2.8198142f,1.7171791f,-0.46419472f,-3.3272424f,-1.4950362f,-1.1797123f,-2.282683f,2.9676335f,-5.4177537f,-2.8707454f,-0.71413887f,-1.4464997f,-1.4974023f,-2.1799068f,0.24860352f,-2.486058f,-2.4466064f,-0.75446844f,2.3532372f,0.41941717f,2.4888787f,-0.78164274f,0.43378296f,-1.721342f,1.2006805f,2.1760168f,-1.661492f,-1.3185276f,5.733749f,-0.51744413f,-1.8107098f,1.1222899f,-3.9681761f,2.776865f,-3.8167524f,3.396475f,0.93383384f,0.2552304f,-4.2181005f,2.6683884f,1.5873309f,-1.2246351f,-5.153086f,1.6335218f,2.5481849f,-4.560124f,-2.896353f,0.8771394f,0.51154786f,4.309291f,-1.5499077f,4.2833204f,-1.3926439f,0.52902657f,-2.9728081f,-1.4234595f,-0.7979618f,2.4381683f,-4.8211374f,5.925887f,-2.5825715f,-0.16588616f,-2.349361f,0.126934f,-0.08447963f,1.0093325f,3.074575f,-0.042348623f,-1.944365f,1.5358431f,2.9581585f,1.7170607f,1.8351394f,0.3145191f,1.2150013f,-2.5166533f,-0.77881974f,-1.9037857f,-2.315637f,1.3543289f,-1.4006455f,-3.3142674f,-2.705139f,-3.3755941f,-5.002767f,5.1136913f,2.3457227f,-1.5658414f,-2.327492f,-2.9704502f,1.3690362f,-0.069811426f,0.19340684f,1.1308577f,3.074551f,-0.87881404f,3.2062864f,1.685166f,-2.1269038f,0.44166744f,-2.0697353f,-2.6192546f,-3.7708402f,-5.1294937f,3.5843992f,-0.077612154f,3.8391402f,4.8605967f,1.7180581f,-2.255542f,2.7453716f,0.7576234f,0.85182035f,0.66181177f,-0.36433223f,-2.11314f,4.3832946f,-1.250106f,-1.5144793f,2.5945473f,-2.6941993f,-1.920129f,-2.4188566f,0.12159391f,0.113336414f,-1.7091397f,0.009618539f,1.6929824f,5.8286743f,4.2497106f,-0.1132178f,0.81335604f,-0.80526066f,-3.0462928f,2.1885252f,-2.0998995f,-5.131595f,-5.3896008f,-3.2713358f,1.2287993f,-2.9120708f,0.76682293f,-0.6213343f,-4.073391f,1.692566f,-0.38447827f,-2.5985255f,-1.840812f,2.811671f,-1.2595141f,3.145905f,3.8981438f,0.13401578f,0.7115034f,-1.6894205f,-1.7063115f,-0.19849652f,-5.7939987f,5.3066297f,-0.684614f,-1.7042308f,-0.4428654f,-1.4500707f,-0.85958016f,2.4639027f,7.7693453f,-4.1641817f,2.7661998f,1.9919335f,-0.53717494f,0.3362031f,-0.5735746f,-2.2009685f,0.27967182f,-4.751361f,-0.396241f,-4.964025f,-1.6622304f,2.8721046f,-4.345663f,-2.5871053f,-4.7869096f,-4.887995f,-2.5869677f,1.523943f,2.0387852f,3.443966f,-1.0396333f,4.1932964f,1.0861341f,-1.5824891f,-0.44700766f,0.47728685f,-2.297977f,2.4297934f,4.6839128f,-3.1931543f,-1.5919391f,0.25565976f,0.874228f,-2.698161f,2.0346842f,-0.8276557f,5.242996f,2.986793f,-0.26455095f,4.1853375f,-2.0894687f,2.329757f,-2.8082523f,-4.2674127f,0.44575596f,1.8808323f,-5.067781f,4.1982694f,0.47001022f,-1.155741f,-2.4845254f,2.191618f,-0.28823784f,1.7602103f,-1.7883106f,-3.3462148f,2.8396857f,4.9062963f,1.9335009f,-3.4304285f,0.99866366f,-0.79481715f,-2.5346122f,-4.3194375f,1.6740069f,1.5394857f,-0.7069206f,2.020487f,-0.38408512f,-1.9777566f,-0.99417293f,2.5929499f,2.3981276f,-3.3429182f,-6.7246094f,-1.6400957f,-2.2513287f,0.39485908f,-1.2468437f,-0.9371821f,-4.0945153f,-0.7099663f,-0.89267087f,2.0928757f,-2.3938847f,-0.15852684f,2.3638763f,1.9523371f,-1.924802f,0.842494f,-0.47635117f,3.297962f,-1.3381544f,0.74309546f,5.0338893f,-1.9804446f,6.192931f,-0.29872504f,1.731221f,0.76694727f,2.272891f,1.1897879f,-1.1798254f,1.9017526f,4.9587965f,-5.5983458f,1.7311727f,0.81246763f,-7.5532527f,-1.2297063f,3.2484083f,-3.1524427f,3.2323241f,-0.42606065f,3.5528843f,1.3201904f,-5.7877765f,2.2990963f,1.7059782f,1.0674224f,1.8219863f,0.96162975f,0.7007541f,3.167812f,4.6693554f,-1.4099572f,-0.51354384f,3.901899f,1.6887386f,1.3888056f,0.39562842f,0.67933035f,0.27917194f,2.5236266f,-0.38258448f,3.721795f,-1.5756158f,2.036778f,-5.881221f,1.4999055f,-1.795219f,0.7808386f,-2.8634663f,-0.5153524f,-0.73608434f,-0.42259476f,3.5805862f,0.7088095f,5.555171f,3.4033022f,2.5962331f,-2.3410444f,-2.7856843f,-2.8164184f,2.909466f,0.96432304f,-1.4590721f,-1.2336974f,4.6245413f,-0.42559132f,-0.8576341f,-1.0669954f,1.5193919f,1.6303487f,-0.4351662f,-4.530991f,1.5478038f,-1.6435916f,-1.6643834f,0.92393094f,1.7935859f,1.258251f,-7.0756655f,-0.41127288f,-3.0469372f,-0.9023981f,1.7363425f,-3.69673f,2.0991046f,0.70963717f,2.0077841f,-1.74325f,-3.9490302f,-1.3300233f,2.9538145f,-1.445918f,3.691097f,1.7303475f,-4.7079744f,-0.8529896f,3.3839874f,-2.8207462f,-1.2067815f,-2.4665248f,-0.13402626f,-4.0612254f,-1.6851022f};
        long star = System.currentTimeMillis();
        List<Feature> features = new ArrayList<>();
        features.add(new Feature(null, featute));
//        features.add(new Feature(null, feature2));
//        CompareParam param = new CompareParam(new Ar磁盘rayList<String>(), null,"2018-07-16", "2018-07-18", features, 0.8f, 25, true);
//        AllReturn<SearchResult> resultAllReturn = service.retrievalOnePerson(param);
//        System.out.println("++++++++++++++++++++++++++++++++++");
//        System.out.println("compare1 "+ (System.currentTimeMillis() - star));
//        Thread.sleep(1000 * 20);

//        long compare1 = System.currentTimeMillis();
//        CompareParam param2 = new CompareParam(ipcIds, null,"2018-07-16", "2018-07-18", features, 0.8f, 25, true);
//        AllReturn<SearchResult> resultAllReturn2 = service.retrievalOnePerson(param2);
//        System.out.println("compare2 "+ (System.currentTimeMillis() - compare1));
//        Thread.sleep(1000 * 20);
        for(int i = 1 ; i<= 1000 ; i ++) {

            long compare2 = System.currentTimeMillis();
            CompareParam param3 = new CompareParam(null, null, "2018-08-01", "2018-08-02", features, 0.9f, 25, true);
            AllReturn<SearchResult> resultAllReturn3 = service.retrievalOnePerson(param3);
            System.out.println("compare" + i + " " + (System.currentTimeMillis() - compare2));
            FaceObjectUtil.objectToJson(resultAllReturn3.getResult());
            System.out.println(resultAllReturn3.getResult().get(0).getRecords().length);
            Thread.sleep(1000L * 5);

        }
    }
}
